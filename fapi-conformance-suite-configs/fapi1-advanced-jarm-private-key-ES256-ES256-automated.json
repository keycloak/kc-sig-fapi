{
    "alias": "keycloak",
    "description": "FAPI1-Advanced-Final,JARM: Keycloak test with private_key_jwt client authentication (RequestObject:ES256/IDToken:ES256)",
    "server": {
        "discoveryUrl": "https://as.keycloak-fapi.org/auth/realms/test/.well-known/openid-configuration"
    },
    "client": {
        "client_id": "client1-private_key_jwt-ES256-ES256-fapi1-advanced-jarm",
        "scope": "openid email",
        "jwks": {
    "keys": [
        {
            "use": "sig",
            "kty": "EC",
            "kid": "client1-ES256",
            "crv": "P-256",
            "alg": "ES256",
            "x": "KhIuh2un6UWcBCIQqr5s3lSN42mrp5kjdf3JrasR1E4",
            "y": "bUIXyjZ6Q7-fLu-mp56OJjEHOAbGd3X30EMhS7SG-Vw",
            "d": "zngKYq2KBIRGiawAAZQJ0K_ZxL3VyZbOHYScKtrOWX0"
        }
    ]
} 
    },
    "client2": {
        "client_id": "client2-private_key_jwt-ES256-ES256-fapi1-advanced-jarm",
        "scope": "openid email",
        "jwks": {
    "keys": [
        {
            "use": "sig",
            "kty": "EC",
            "kid": "client2-ES256",
            "crv": "P-256",
            "alg": "ES256",
            "x": "X1K2NP56XffP8ZvkSJiD3ZiaD6A1forvWkZ2AzqbyME",
            "y": "S2GQUKAw0gW5kT-lEehLkt02PxA6CukInQhvo1hWcNo",
            "d": "xDb8I6rF-rMPo5MV-rZSZZRwk1-TYJCm6SK4JGeP7Gk"
        }
    ]
} 
    },
    "mtls": {
        "cert": "-----BEGIN CERTIFICATE-----\nMIIDKDCCAs6gAwIBAgIUXl6GT8Ex1EENFSPveDA8fUoqHAwwCgYIKoZIzj0EAwIw\ndjELMAkGA1UEBhMCSlAxEzARBgNVBAgTClByaXZhdGUgQ0ExFzAVBgNVBAoTDlNl\nY3VyZSBPU1MgU2lnMRYwFAYDVQQLEw1LZXljbG9hay1mYXBpMSEwHwYDVQQDExhL\nZXljbG9hay1mYXBpIFByaXZhdGUgQ0EwHhcNMTkwNTIxMDIwNDAwWhcNMjQwNTE5\nMDIwNDAwWjBhMQswCQYDVQQGEwJKUDEPMA0GA1UECBMGQ2xpZW50MRcwFQYDVQQK\nEw5TZWN1cmUgT1NTIFNpZzEWMBQGA1UECxMNS2V5Y2xvYWstZmFwaTEQMA4GA1UE\nAxMHY2xpZW50MTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAM74QUE+\nRfLtdHCKj1QXRQkj30AtveZa/7jbBpHYJCoSGA4bzuNE04HTK02hwtBO0J0bvbRy\n14BYHimwhUY6n7gtZKex3JQ39QC2UHbIOtIQXvCgbn6K4iU6WrUbCK4I8p77gIk4\nMXQmsCQokAtxsF1eq/RyLhRJXo/aTwcHDWcb5n8jFGmpOJyhmPEXwtzqMZwO9Y+a\nI3d5P/xHXnb84zrgRJH2YMzTKOfGt72I8Ag34ITTQUxox5RUMMGwqlzN6bEYIF9l\nyCcd3kCSgyp4b4wNBc5h5g3GPDBTCUx3z07oQ50LR7AAICevHvWGlUxXtX+MYc6+\nMvjb3l/e+EEldb0CAwEAAaOBgzCBgDAOBgNVHQ8BAf8EBAMCBaAwEwYDVR0lBAww\nCgYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADAdBgNVHQ4EFgQURPpQRYqk1GU0v615\n9IJV4fo7s8YwHwYDVR0jBBgwFoAUJmT6o2FQqWh2KBGYB3nfWHkAtEgwCwYDVR0R\nBAQwAoIAMAoGCCqGSM49BAMCA0gAMEUCIHImOqdaMfLN1M7i4wfXKIGnJHDlEv8B\n3jASpdlMb35IAiEA5oj7fyh0KxGG9Z4kUGusBUYidOemP81CtyOPzg1A64w=\n-----END CERTIFICATE-----\n",
        "key": "-----BEGIN RSA PRIVATE KEY-----\nMIIEpQIBAAKCAQEAzvhBQT5F8u10cIqPVBdFCSPfQC295lr/uNsGkdgkKhIYDhvO\n40TTgdMrTaHC0E7QnRu9tHLXgFgeKbCFRjqfuC1kp7HclDf1ALZQdsg60hBe8KBu\nforiJTpatRsIrgjynvuAiTgxdCawJCiQC3GwXV6r9HIuFElej9pPBwcNZxvmfyMU\naak4nKGY8RfC3OoxnA71j5ojd3k//EdedvzjOuBEkfZgzNMo58a3vYjwCDfghNNB\nTGjHlFQwwbCqXM3psRggX2XIJx3eQJKDKnhvjA0FzmHmDcY8MFMJTHfPTuhDnQtH\nsAAgJ68e9YaVTFe1f4xhzr4y+NveX974QSV1vQIDAQABAoIBAQCbyK7NXgMmi+b2\nAsVJZU54R8D1vLhQWDRdPrceNdNau03R6Mp7tEWDVaAlidlqE7jgWI4c8cgVeb4S\nYSSfrOalqb02oCDIi6nlRFUiYyorDVl4wzkIFJ+Np/O4l8WbwW5ljia8okhPBgPU\n45cwlf1K+kRx9TOL34HGw2pyfrNu5G1NWs3a30qHVc5FnKBgJq4PZgxtTC15DoQ4\nU8IF7M9XYlXOkx3zSOjk2mpQaOPDeRWBwoFsoxqOl+x3/u9rhiGW+9OXEltq+AKA\nlsZ4QVfvmjIZ65c5SJwrV+OhLIKOoA8TzheBGKZ4vkKt17GxWsm7KP1afh1fqc5C\nd1lE0e1BAoGBAPI5SKi+HKuMsWY6YLv0c6j/FHJ/ZnSLLYc6/edfXso0djuz7BOf\nmLjgnntDrWTf6jWJ14DMDZVaohFr69eham8N9H9bQl7tpdtswRL0IVfOZYbEBbQk\n57/l5yADZcxvOMne/yh8K8LARYdFe5WDHCijgLhqmENenRHhHUjAuPVxAoGBANq9\nrnqQ6j4n2GEx+YhIKOflCUWwUe9XQ8pdQwniDQkQ3imOsOLn/nMXUO1oUMbaH0cb\nQ0+e5QGW74alTaFkQxBeSTbvZplMtwgaKDl2GzlYFPUxSLkAf5crChjT0z5t74Rv\nChCvoLLxXXD+PmkC1Hpub78bfEwqit54fVGMJW8NAoGBAMzk8fZzYnMmvwU3io5T\nOOcSZqx34iXheTC0EQT/4oHvILhd+OucjCaPMuAYHnt/AXIqWJYFhdP557AO91/e\nlda9Gj4E5z6/jhXvh97Njcrlt3HpLN32fecQxZKJ7TmiN4pjzLjlWGsUE3xapTCS\nyGYD8KWO3Z/XT8xI/WmGRK6xAoGBAMBmaUr7nl4vk/7iAzehKQHYDpDSpy8bldAw\nuh++SnL3+EGbdfEP2FsJXjCEOdC+2RYlX85v18TPKz5GtgLIesix9jow1xDuTmv8\n/faU8Rs+Y6jLwcigLJodzFLMNxnJfw0A0lyc7n+XF/akWubpC1XpP7dcCLfCD8Xh\nO3F4EREdAoGAQRNaIHonLPVg+cZAVR6DAKj7l20tE1THRfHrkJDoM661hl7EnPL3\n0SoLJyKYh3uil+/XAMtdegE5nrumg25FKdDY+JvSSvqEI0dLqKZzc6PBRau3+KVU\nVAYQtvtH7E2uJ7oFzFepTp2mq1I7+BYEmTIaPDJvf/l5gz+vy+voLrs=\n-----END RSA PRIVATE KEY-----\n"
    },
    "mtls2": {
        "cert": "-----BEGIN CERTIFICATE-----\nMIIDJjCCAs6gAwIBAgIUKHCTpsodVknyAZC7gFy3hZZqTtEwCgYIKoZIzj0EAwIw\ndjELMAkGA1UEBhMCSlAxEzARBgNVBAgTClByaXZhdGUgQ0ExFzAVBgNVBAoTDlNl\nY3VyZSBPU1MgU2lnMRYwFAYDVQQLEw1LZXljbG9hay1mYXBpMSEwHwYDVQQDExhL\nZXljbG9hay1mYXBpIFByaXZhdGUgQ0EwHhcNMTkwNTIxMDIwNDAwWhcNMjQwNTE5\nMDIwNDAwWjBhMQswCQYDVQQGEwJKUDEPMA0GA1UECBMGQ2xpZW50MRcwFQYDVQQK\nEw5TZWN1cmUgT1NTIFNpZzEWMBQGA1UECxMNS2V5Y2xvYWstZmFwaTEQMA4GA1UE\nAxMHY2xpZW50MjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMlwHpEQ\nVCrBo1yRmKACefdDiGLunW+REQHmTWUTEokWdVCsMGjqns1E4h68nmXVApXtyuGL\nF3IVzJrUQ6DQXCKdPpmoFplD6aC0CdFVouY8XULyny8d1aNl+1nrFFaiamW2JxD9\nPbtUKfE/TVMM+bums+gHW63KrJo7OnfEC0wvuEwY4vVDvL5DhxoURTU8YhBUxDvA\nnfQfD4TJEVqEiIt/0vTwrdEoRlHTwaJadcyKdUKvNVG1O1RGlsPm63qS2XkG4Qvw\nasIuhoxuUZbr74S9mlDQV33k/XCWj/nOr+58xCaXNKGOI9TlFA4+YUclJxy/GeBZ\nB0OmSitP5swqpCkCAwEAAaOBgzCBgDAOBgNVHQ8BAf8EBAMCBaAwEwYDVR0lBAww\nCgYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADAdBgNVHQ4EFgQUT8nMrrlLi/LQTlb3\nk6QnqLwpGT0wHwYDVR0jBBgwFoAUJmT6o2FQqWh2KBGYB3nfWHkAtEgwCwYDVR0R\nBAQwAoIAMAoGCCqGSM49BAMCA0YAMEMCID4FMD7NJZFeO4X26GifL4ODr/vK+Nje\noAcnXdYo5WX7Ah8OifloGxnCplM7doLaG+LaE8r9VEi6QyD29NAIPUPe\n-----END CERTIFICATE-----\n",
        "key": "-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEAyXAekRBUKsGjXJGYoAJ590OIYu6db5ERAeZNZRMSiRZ1UKww\naOqezUTiHryeZdUCle3K4YsXchXMmtRDoNBcIp0+magWmUPpoLQJ0VWi5jxdQvKf\nLx3Vo2X7WesUVqJqZbYnEP09u1Qp8T9NUwz5u6az6Adbrcqsmjs6d8QLTC+4TBji\n9UO8vkOHGhRFNTxiEFTEO8Cd9B8PhMkRWoSIi3/S9PCt0ShGUdPBolp1zIp1Qq81\nUbU7VEaWw+brepLZeQbhC/Bqwi6GjG5RluvvhL2aUNBXfeT9cJaP+c6v7nzEJpc0\noY4j1OUUDj5hRyUnHL8Z4FkHQ6ZKK0/mzCqkKQIDAQABAoIBAC6BHe1rkaLVVXuX\neV7nc3TsOF5urBYHrZ98pb2B67OOZcMcHYj7MXI+Rt3FuePUi2ZFoaL0U5NZCQVt\nn7dOoxayqrMapSz5CsS5C9MyLAtvQDCmhq1/+8RfVOnrZaSilmGo7df0Pv4ybgRu\nEtHrmvQBhmM436d9tN9ecR8ZOWp66Luy1GVM6rwH6ceOc46ZHUwoumN0kQt/G72G\n0QRbt7iGle/s11TzEKh3YaR9gkS+KPm5K+iPzSP1FxDiwSrKLRQJSjANrzTKEkuQ\nyDm7MSYm23guxosA/4Oyaa+7SDEqk9509yiDp51HK9fFJWnuBoDt7iduz0VJVqHg\nq0lE9wECgYEA08hkjl9PKMTX8vN9cOX+0W4en3K10Jjonw4d2gS2dIyb8o7B4ulb\nfGpleMAmcyGuG+k8fC8nSjqYSx4YHPunbmK1O4PCGTi8r6BtD9zW8opJVi+ImMsa\nn8l8bUASOuOFrHhvnB/JZS3yoOZVE8ey6/5QtSjwbn6I7dAvXXgT5pkCgYEA837O\nFMLfbWoYvdEa9LXmXGWagQe7Ta09BGbJ1Qs1hpuZJl8qK0kVWTDURtr5yu24r7YQ\n3S3cqKcg3FB3XO+vjreYKl2Cww/v8Wy/glGgqkAhd0dP9K1Q8F8XeQPlrPkNANrG\njIlNFYmg163EDwLJ+IoRr+t43KbIoGvsb9kTdBECgYEAh1keys6mrIuA58gtdyXG\nQNp7v7Nz9yiCIoTHFzrD0KC8WbxatUYmLdFhoFZNPG9d8oCRI1yPY6UnB3roNj2u\nt6Fl6e8+8ReNn0CL8wNUbBVs4SPnzJ6hGVWPq9Ky0+fs2ljuG31FHODMm4AZB1ct\nRh12PxE296buo+3VF4tSTKECgYEA4dUW73x52rHPNqWs+Y+HkuSNMuTn3DgzYlSv\nFw+pWioQFd2nb7P9v9Yg24KWsJZgd19GLs0tXaJ8QLnEqwaGbbhrwccu0xmB8glp\naUWp3J1ULJuQVZ81dWrMi2mI6C+o1sUR5yAkxTf7XG4Ga+GrTv9HPkEHvKZXZyoR\nhP7xIvECgYB6S0i6ruOAFq2iMyGoX83RlWjo+WrGqSVWfzRZ43rFQ3MBEIlkQD3K\n6+Y+v0MMlgrN3VQTi31IW42ftgOIiy7ZndMvBaQd2Zp4POtNISsRysQJcewPwbL0\nVXsalNqW+Rl8PDzrd6s13wYogMuWrwmbPphC04LdBhZb6nX6KVkn0A==\n-----END RSA PRIVATE KEY-----\n"
    },
    "resource": {
        "resourceUrl": "https://rs.keycloak-fapi.org/"
    },
    "browser": [
        {
            "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
            "tasks": [
                {
                    "task": "Initial Login",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "optional": true,
                    "commands": [
                        [
                            "text",
                            "name",
                            "username",
                            "john"
                        ],
                        [
                            "text",
                            "name",
                            "password",
                            "john"
                        ],
                        [
                            "click",
                            "name",
                            "login"
                        ]
                    ]
                },
                {
                    "task": "Verify Complete",
                    "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                    "commands": [
                        [
                            "wait",
                            "id",
                            "submission_complete",
                            10
                        ]
                    ]
                }
            ]
        }
    ],
    "override": {
        "fapi1-advanced-final": {
            "browser": [
                {
                    "comment": "Must grant consent to user attributes being shared in first browser login for user john",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Initial login",
                            "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                            "optional": true,
                            "commands": [
                                [
                                    "text",
                                    "id",
                                    "username",
                                    "john"
                                ],
                                [
                                    "text",
                                    "id",
                                    "password",
                                    "john"
                                ],
                                [
                                    "click",
                                    "name",
                                    "login"
                                ]
                            ]
                        },
                        {
                            "task": "Grant Consent",
                            "match": "https://as.keycloak-fapi.org/auth/realms/test/login-actions/required-action*",
                            "optional": true,
                            "commands": [
                                [
                                    "click",
                                    "name",
                                    "accept"
                                ]
                            ]
                        },
                        {
                            "task": "Verify Complete",
                            "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                            "commands": [
                                [
                                    "wait",
                                    "id",
                                    "submission_complete",
                                    10
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-user-rejects-authentication": {
            "browser": [
                {
                    "comment": "Expect user to deny consent after initial login",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Initial login",
                            "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                            "commands": [
                                [
                                    "text",
                                    "id",
                                    "username",
                                    "mike"
                                ],
                                [
                                    "text",
                                    "id",
                                    "password",
                                    "mike"
                                ],
                                [
                                    "click",
                                    "name",
                                    "login"
                                ]
                            ]
                        },
                        {
                            "task": "Authorize Client",
                            "match": "https://as.keycloak-fapi.org/auth/realms/test/login-actions/required-action*",
                            "commands": [
                                [
                                    "click",
                                    "name",
                                    "cancel"
                                ]
                            ]
                        },
                        {
                            "task": "Verify Complete",
                            "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                            "commands": [
                                [
                                    "wait",
                                    "id",
                                    "submission_complete",
                                    10
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-response-mode-query": {
            "browser": [
                {
                    "comment": "expect an immediate redirect back to the conformance suite with an error",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                            "commands": [
                                [
                                    "wait",
                                    "id",
                                    "submission_complete",
                                    10
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-registered-redirect-uri": {
            "browser": [
                {
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                            "commands": [
                                [
                                    "wait",
                                    "xpath",
                                    "//p[text()='Invalid parameter: redirect_uri']",
                                    10,
                                    ".*Invalid parameter: redirect_uri.*",
                                    "update-image-placeholder"
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-request-object-without-exp-fails": {
            "browser": [
                {
                    "comment": "expect an immediate redirect back to the conformance suite with an error",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                            "commands": [
                                [
                                    "wait",
                                    "id",
                                    "submission_complete",
                                    10
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-request-object-without-scope-fails": {
            "browser": [
                {
                    "comment": "expect an immediate redirect back to the conformance suite with an error",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                            "commands": [
                                [
                                    "wait",
                                    "id",
                                    "submission_complete",
                                    10
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-state-only-outside-request-object-not-used": {
            "browser": [
                {
                    "comment": "expect an immediate redirect back to the conformance suite with an error",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                            "commands": [
                                [
                                    "wait",
                                    "id",
                                    "submission_complete",
                                    10
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-request-object-without-nonce-fails": {
            "browser": [
                {
                    "comment": "expect an immediate redirect back to the conformance suite with an error",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                            "commands": [
                                [
                                    "wait",
                                    "id",
                                    "submission_complete",
                                    10
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-request-object-without-redirect-uri-fails": {
            "browser": [
                {
                    "comment": "expect an immediate redirect back to the conformance suite with an error",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Expect redirect invalid uri error page",
                            "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                            "commands": [
                                [
                                    "wait",
                                    "id",
                                    "submission_complete",
                                    10
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-expired-request-object-fails": {
            "browser": [
                {
                    "comment": "expect an immediate redirect back to the conformance suite with an error",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                            "commands": [
                                [
                                    "wait",
                                    "id",
                                    "submission_complete",
                                    10
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-different-nonce-inside-and-outside-request-object": {
            "browser": [
                {
                    "comment": "expect an immediate redirect back to the conformance suite with an error",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                            "commands": [
                                [
                                    "wait",
                                    "id",
                                    "submission_complete",
                                    10
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
         "fapi1-advanced-final-ensure-response-type-code-fails": {
            "browser": [
                {
                    "comment": "expect an immediate redirect back to the conformance suite with an error",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                            "commands": [
                                [
                                    "wait",
                                    "id",
                                    "submission_complete",
                                    10
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-request-object-with-bad-aud-fails": {
            "browser": [
                {
                    "comment": "expect an immediate redirect back to the conformance suite with an error",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                            "commands": [
                                [
                                    "wait",
                                    "id",
                                    "submission_complete",
                                    10
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-matching-key-in-authorization-request": {
            "browser": [
                {
                    "comment": "expect an immediate redirect back to the conformance suite with an error",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "expect an immediate redirect back to the conformance suite with an error",
                            "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                            "commands": [
                                [
                                    "wait",
                                    "xpath",
                                    "//*",
                                    10,
                                    ".*",
                                    "update-image-placeholder"
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-authorization-request-without-request-object-fails": {
            "browser": [
                {
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                            "commands": [
                                [
                                    "wait",
                                    "xpath",
                                    "//p[text()='Invalid Request']",
                                    10,
                                    ".*Invalid Request.*",
                                    "update-image-placeholder"
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-redirect-uri-in-authorization-request": {
            "browser": [
                {
                    "comment": "expect an immediate error page",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Expect redirect uri mismatch error page",
                            "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                            "commands": [
                                [
                                    "wait",
                                    "xpath",
                                    "//*",
                                    10,
                                    ".*Invalid parameter: redirect_uri.*",
                                    "update-image-placeholder"
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-client-id-in-token-endpoint": {
            "browser": [
                {
                    "comment": "expect an immediate redirect back to the conformance suite with an error",
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Initial login",
                            "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                            "commands": [
                                [
                                    "text",
                                    "id",
                                    "username",
                                    "john"
                                ],
                                [
                                    "text",
                                    "id",
                                    "password",
                                    "john"
                                ],
                                [
                                    "click",
                                    "name",
                                    "login"
                                ]
                            ]
                        },
                        {
                            "task": "Verify Complete",
                            "match": "https://conformance-suite.keycloak-fapi.org/test/a/keycloak/callback*",
                            "commands": [
                                [
                                    "wait",
                                    "id",
                                    "submission_complete",
                                    10
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-signed-request-object-with-RS256-fails": {
            "browser": [
                {
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                            "commands": [
                                [
                                    "wait",
                                    "xpath",
                                    "//p[text()='Invalid Request']",
                                    10,
                                    ".*Invalid Request.*",
                                    "update-image-placeholder"
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-request-object-with-invalid-signature-fails": {
            "browser": [
                {
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                            "commands": [
                                [
                                    "wait",
                                    "xpath",
                                    "//p[text()='Invalid Request']",
                                    10,
                                    ".*Invalid Request.*",
                                    "update-image-placeholder"
                                ]
                            ]
                        }
                    ]
                }
            ]
        },
        "fapi1-advanced-final-ensure-request-object-signature-algorithm-is-not-none": {
            "browser": [
                {
                    "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                    "tasks": [
                        {
                            "task": "Verify Complete",
                            "match": "https://as.keycloak-fapi.org/auth/realms/test/protocol/openid-connect/auth*",
                            "commands": [
                                [
                                    "wait",
                                    "xpath",
                                    "//p[text()='Invalid Request']",
                                    10,
                                    ".*Invalid Request.*",
                                    "update-image-placeholder"
                                ]
                            ]
                        }
                    ]
                }
            ]
        }
    }
}
